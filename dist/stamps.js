(()=>{"use strict";var e,t;!function(){e=s,t=l;var n=["DodgerBlue","OliveDrab","Gold","Pink","SlateBlue","LightBlue","Violet","PaleGreen","SteelBlue","SandyBrown","Chocolate","Crimson"],a=!1,r=null,i=[],d=0;function o(e,t,a){return e.color=n[Math.random()*n.length|0],e.x=Math.random()*t,e.y=Math.random()*a-a,e.diameter=10*Math.random()+5,e.tilt=10*Math.random()-10,e.tiltAngleIncrement=.07*Math.random()+.05,e.tiltAngle=0,e}function s(){var e=window.innerWidth,t=window.innerHeight;window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,16.6666667)};var n=document.getElementById("confetti-canvas");null===n&&((n=document.createElement("canvas")).setAttribute("id","confetti-canvas"),n.setAttribute("style","display:block;z-index:999999;pointer-events:none"),document.body.appendChild(n),n.width=e,n.height=t,window.addEventListener("resize",(function(){n.width=window.innerWidth,n.height=window.innerHeight}),!0));for(var s=n.getContext("2d");i.length<150;)i.push(o({},e,t));a=!0,null===r&&function e(){s.clearRect(0,0,window.innerWidth,window.innerHeight),0===i.length?r=null:(function(){var e,t=window.innerWidth,n=window.innerHeight;d+=.01;for(var r=0;r<i.length;r++)e=i[r],!a&&e.y<-15?e.y=n+100:(e.tiltAngle+=e.tiltAngleIncrement,e.x+=Math.sin(d),e.y+=.5*(Math.cos(d)+e.diameter+10),e.tilt=15*Math.sin(e.tiltAngle)),(e.x>t+20||e.x<-20||e.y>n)&&(a&&i.length<=150?o(e,t,n):(i.splice(r,1),r--))}(),function(e){for(var t,n,a=0;a<i.length;a++)t=i[a],e.beginPath(),e.lineWidth=t.diameter,e.strokeStyle=t.color,n=t.x+t.tilt,e.moveTo(n+t.diameter/2,t.y),e.lineTo(n,t.y+t.tilt+t.diameter/2),e.stroke()}(s),r=requestAnimFrame(e))}()}function l(){a=!1}}();const n="#ca675a",a="#59a079",r=localStorage.getItem("currentQrCode");let i=JSON.parse(localStorage.getItem("users")),d={};const o=document.querySelector("#qrCode"),s=document.querySelector(".stampCards"),l=e=>e.guid===r,m=i.find(l),c=i.findIndex(l);function u(e,t){e.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill=${t} d="M448 336v-288C448 21.49 426.5 0 400 0H96C42.98 0 0 42.98 0 96v320c0 53.02 42.98 96 96 96h320c17.67 0 32-14.33 32-31.1c0-11.72-6.607-21.52-16-27.1v-81.36C441.8 362.8 448 350.2 448 336zM143.1 128h192C344.8 128 352 135.2 352 144C352 152.8 344.8 160 336 160H143.1C135.2 160 128 152.8 128 144C128 135.2 135.2 128 143.1 128zM143.1 192h192C344.8 192 352 199.2 352 208C352 216.8 344.8 224 336 224H143.1C135.2 224 128 216.8 128 208C128 199.2 135.2 192 143.1 192zM384 448H96c-17.67 0-32-14.33-32-32c0-17.67 14.33-32 32-32h288V448z"/></svg><span></span>`}var g;function w(){i[c]=m,localStorage.setItem("users",JSON.stringify(i))}document.querySelector(".userName").textContent=m.name,function(e){for(let t=0;t<e.length;t++){if("inactive"===e[t].status)continue;let n=document.createElement("div"),r=document.createElement("div"),i=document.createElement("h2"),d=document.createElement("div");d.classList.add("bonusCount"),i.textContent=e[t].name.no,r.classList.add("programContainerContainer"),r.setAttribute("data-id",e[t].id),n.setAttribute("data-id",e[t].id),n.classList.add("programContainer");for(let r=0;r<e[t].stamps.max;r++){e[t].stamps.current===e[t].stamps.max&&1!=e[t].stamps.max&&(e[t].stamps.current=0);let i=document.createElement("div");i.classList.add("stampBox"),i.setAttribute("data-id",e[t].id),i.classList.add("addStamp"),e[t].stamps.current>r&&u(i,a),n.appendChild(i)}s.appendChild(r),r.appendChild(i),r.appendChild(n),r.appendChild(d);let o=document.createElement("button");if(o.setAttribute("type","button"),o.setAttribute("data-id",e[t].id),o.classList.add("addStamp"),o.textContent="Registrer kjøp",n.appendChild(o),e[t].tags.includes("akademika"))if(e[t].transferedFromAkademika)r.classList.add("transferedFromAkademika");else{let e=document.createElement("button");e.classList.add("akademikaButton"),e.textContent="Overfør fra akademika",r.appendChild(e),e.addEventListener("click",(()=>{var e;e=m.rewardPrograms.findIndex((e=>e.tags.includes("akademika"))),m.rewardPrograms[e].transferedFromAkademika=!0,w(),location.reload()}))}}}(m.rewardPrograms),document.querySelectorAll(".addStamp").forEach((r=>{r.addEventListener("click",(r=>{r.target.dataset.id&&function(r){const i=m.rewardPrograms.findIndex((e=>e.id===+r)),o=m.rewardPrograms[i].stamps.max;let s=m.rewardPrograms[i].stamps.current;const l=document.querySelectorAll(`.programContainer[data-id="${r}"] .stampBox`),c=document.querySelector(`.programContainerContainer[data-id="${r}"] .bonusCount`),g=document.querySelector(`.programContainerContainer[data-id="${r}"]`);"open"===m.rewardPrograms[i].type?s>=o?(l.forEach((e=>e.textContent="")),m.rewardPrograms[i].stamps.current=1,u(l[0],a)):(m.rewardPrograms[i].stamps.current+=1,s===o-1?(u(l[s],n),d[r]=d[r]?d[r]+1:1,c.textContent=`Antall bonuser for denne handel:   ${d[r]}`,g.classList.add("bonusTriggered"),e(),setTimeout(t,1600)):u(l[s],a)):"manual"===m.rewardPrograms[i].type&&(l[s].classList.add("usedCoupon"),g.classList.add("bonusTriggered"),c.textContent="Kupong benyttet",u(l[0],n),m.rewardPrograms.splice(i,1)),w()}(r.target.dataset.id)}))})),window.addEventListener("keypress",(e=>{"Enter"===e.key&&(newQrCode=o.value,o.value="",i.some((e=>e.guid===newQrCode))&&(localStorage.setItem("currentQrCode",newQrCode),location.reload()))})),o.addEventListener("blur",(()=>{setTimeout((()=>{o.focus()}),20)})),g=void 0,g=0,["click","mousemove","touchstart","touchmove"].forEach((e=>{window.addEventListener(e,(()=>g=0))})),setInterval((()=>{++g>10&&(window.location.href="index.html")}),1e3)})();